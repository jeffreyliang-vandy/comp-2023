<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2021-Applied-Code</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="2021-Applied_files/libs/clipboard/clipboard.min.js"></script>
<script src="2021-Applied_files/libs/quarto-html/quarto.js"></script>
<script src="2021-Applied_files/libs/quarto-html/popper.min.js"></script>
<script src="2021-Applied_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="2021-Applied_files/libs/quarto-html/anchor.min.js"></script>
<link href="2021-Applied_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="2021-Applied_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="2021-Applied_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="2021-Applied_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="2021-Applied_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">2021-Applied-Code</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section">4.</h2>
<p>15 pts Imagine that you are in a meeting to devise a statistical analysis plan for an upcoming cohort study of N = 3,000 subjects (to be sampled independently) in which the primary aim is to compare some continuous outcome, Y , between two groups defined by an exposure status. The exposure occurs in about one-third of individuals in the population. Is is suspected a priori that the outcome variance in the exposed group will be substantively larger in the exposed group as compared to the unexposed group (due to, e.g., heterogeneous response to the exposure). Despite this, your collaborator suggests Student’s t-test (i.e., the t-test that assumes equal variances between groups) in order test the hypothesis of a nonzero mean difference, as this has been standard in the literature. As the group’s biostatistician, you perform a simulation to illustrate the possible pitfalls of this approach. The R function to conduct the simulation is shown below (mind the line numbers on the left-hand side, as questions (a)-(e) below refer to them):</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">## add notation for the R code</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>simulation <span class="op">&lt;-</span> function(N, p.exp, sigma0, k, nsim, seed) {</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span>.seed(seed) <span class="co"># set seed</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>results <span class="op">&lt;-</span> matrix(<span class="dv">0</span>, ncol <span class="op">=</span> <span class="dv">1</span>, nrow <span class="op">=</span> nsim) <span class="co"># initialize results</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="kw">in</span> <span class="dv">1</span>:nsim) { <span class="co"># loop over nsim</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>x <span class="op">&lt;-</span> rbinom(n <span class="op">=</span> N, size <span class="op">=</span> <span class="dv">1</span>, prob <span class="op">=</span> p.exp) <span class="co"># generate x</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>N1 <span class="op">&lt;-</span> <span class="bu">sum</span>(x) <span class="co"># number of treated</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>N0 <span class="op">&lt;-</span> N <span class="op">-</span> <span class="bu">sum</span>(x) <span class="co"># number of control</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">&lt;-</span> rnorm(n <span class="op">=</span> N0, mean <span class="op">=</span> <span class="dv">0</span>, sd <span class="op">=</span> sigma0) <span class="co"># generate y0</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">&lt;-</span> rnorm(n <span class="op">=</span> N1, mean <span class="op">=</span> <span class="dv">0</span>, sd <span class="op">=</span> sqrt(k <span class="op">*</span> sigma0<span class="op">^</span><span class="dv">2</span>)) <span class="co"># generate y1</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>p <span class="op">&lt;-</span> t.test(x <span class="op">=</span> y0, y <span class="op">=</span> y1, var.eq <span class="op">=</span> TRUE)$p.value <span class="co"># t-test</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>results[j, <span class="dv">1</span>] <span class="op">&lt;-</span> <span class="im">as</span>.numeric(p <span class="op">&lt;</span> <span class="fl">0.05</span>) <span class="co"># store results</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span>(colMeans(results)) <span class="co"># return the average</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>simulation(N<span class="op">=</span><span class="dv">3000</span>, p.exp<span class="op">=</span><span class="dv">1</span><span class="op">/</span><span class="dv">3</span>,  sigma0<span class="op">=</span><span class="dv">10</span>, k<span class="op">=</span><span class="dv">2</span>, nsim<span class="op">=</span><span class="dv">50000</span>, seed<span class="op">=</span><span class="dv">2021</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.07926</code></pre>
</div>
</div>
<ol type="a">
<li><p>Briefly explain the major purpose of the seed argument (referred to on Line 3).</p></li>
<li><p>Briefly explain what Lines 7-9 of the simulation code are doing.</p></li>
<li><p>Briefly explain the role of the k argument (referred to on Line 11).</p></li>
<li><p>In the language of hypothesis testing, what does the number “0.05” refer to on Line 13?</p></li>
<li><p>In the language of hypothesis testing, what is the value returned by the function (Line 15)?</p></li>
<li><p>Briefly summarize the main result of the simulation study and highlight the importance of its implica- tions.</p></li>
<li><p>What alternative test would you suggest to answer your collaborator’s scientific question?</p></li>
<li><p>Illustrate the advantage of the approach you identified in part (g) by re-running the simulation study under the same setup, but making a single key modification to the function. Specifically state the change you’ve made, and briefly summarize your findings.</p></li>
</ol>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">## add notation for the R code</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>simulation <span class="op">&lt;-</span> function(N, p.exp, sigma0, k, nsim, seed) {</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span>.seed(seed) <span class="co"># set seed</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>results <span class="op">&lt;-</span> matrix(<span class="dv">0</span>, ncol <span class="op">=</span> <span class="dv">1</span>, nrow <span class="op">=</span> nsim) <span class="co"># initialize results</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="kw">in</span> <span class="dv">1</span>:nsim) { <span class="co"># loop over nsim</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>x <span class="op">&lt;-</span> rbinom(n <span class="op">=</span> N, size <span class="op">=</span> <span class="dv">1</span>, prob <span class="op">=</span> p.exp) <span class="co"># generate x</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>N1 <span class="op">&lt;-</span> <span class="bu">sum</span>(x) <span class="co"># number of treated</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>N0 <span class="op">&lt;-</span> N <span class="op">-</span> <span class="bu">sum</span>(x) <span class="co"># number of control</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">&lt;-</span> rnorm(n <span class="op">=</span> N0, mean <span class="op">=</span> <span class="dv">0</span>, sd <span class="op">=</span> sigma0) <span class="co"># generate y0</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">&lt;-</span> rnorm(n <span class="op">=</span> N1, mean <span class="op">=</span> <span class="dv">0</span>, sd <span class="op">=</span> sqrt(k <span class="op">*</span> sigma0<span class="op">^</span><span class="dv">2</span>)) <span class="co"># generate y1</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>p <span class="op">&lt;-</span> t.test(x <span class="op">=</span> y0, y <span class="op">=</span> y1, var.eq <span class="op">=</span> F)$p.value <span class="co"># t-test</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>results[j, <span class="dv">1</span>] <span class="op">&lt;-</span> <span class="im">as</span>.numeric(p <span class="op">&lt;</span> <span class="fl">0.05</span>) <span class="co"># store results</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span>(colMeans(results)) <span class="co"># return the average</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>simulation(N<span class="op">=</span><span class="dv">3000</span>, p.exp<span class="op">=</span><span class="dv">1</span><span class="op">/</span><span class="dv">3</span>,  sigma0<span class="op">=</span><span class="dv">10</span>, k<span class="op">=</span><span class="dv">2</span>, nsim<span class="op">=</span><span class="dv">50000</span>, seed<span class="op">=</span><span class="dv">2021</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04986</code></pre>
</div>
</div>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1">5.</h2>
<p>50 pts Suppose you are working with a team that is interested in understanding the link between recreational drug use and subsequent visits to the emergency room (ER). They collect data on N = 400 independently sampled individuals and survey them on their history of drug use. If a subject had an ER visit within five years of study enrollment, it was noted (data set: er.csv). The variables in the data set are as follows:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>er <span class="op">=</span> pd.read_csv(<span class="st">"./er.csv"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>er.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>agegrp</th>
      <th>tob</th>
      <th>alc</th>
      <th>mrj</th>
      <th>illeg</th>
      <th>er</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<ol type="a">
<li>Briefly summarize the distribution of variables in the data set. You may include tables and figures if you choose, but your response should not exceed one double-spaced page (tables and figures included).</li>
</ol>
<div class="cell" data-execution_count="13">
<div class="cell-output cell-output-stdout">
<pre><code>agegrp   0   1   2   3   4
er                        
0       79  58  51  68  48
1       22  26  11  17  20

tob    0   1
er          
0    239  65
1     67  29

alc    0    1
er           
0    153  151
1     57   39

mrj    0   1
er          
0    273  31
1     77  19

illeg    0   1
er            
0      286  18
1       95   1
</code></pre>
</div>
</div>
<ol start="2" type="a">
<li>Perform a principled analysis in which you investigate the association between recreational drug use and ER visits. When writing your response:</li>
</ol>
<p>• Remember that this is an open-ended question in which there are multiple defensible ways to respond. Please select and implement only one approach (that may or may not involve results from more than one model).</p>
<p>• Describe the method you are implementing such that it could essentially be replicated without having to look at your code.</p>
<p>• Clearly state and briefly defend any choices you make in your analysis.</p>
<p>• Present and interpret your results using suitable measures of association that could be understand- able to a scientific collaborator.</p>
<p>• You may include tables and/or figures if you believe they will aid the presentation of your response.</p>
<p>• Concede at least one limitation of the approach you choose.</p>
<p>• Your response should be no longer than two double-spaced pages (including tables and figures, but excluding code.</p>
<p>• Please present code only as an appendix.</p>
<div class="cell" data-execution_count="25">
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.522541
         Iterations 7
                           Logit Regression Results                           
==============================================================================
Dep. Variable:                     er   No. Observations:                  400
Model:                          Logit   Df Residuals:                      395
Method:                           MLE   Df Model:                            4
Date:                Thu, 11 May 2023   Pseudo R-squ.:                 0.05179
Time:                        13:04:52   Log-Likelihood:                -209.02
converged:                       True   LL-Null:                       -220.43
Covariance Type:            nonrobust   LLR p-value:                 0.0001368
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     -1.1091      0.164     -6.772      0.000      -1.430      -0.788
tob            0.5126      0.302      1.697      0.090      -0.079       1.104
alc           -0.5861      0.263     -2.226      0.026      -1.102      -0.070
mrj            1.1660      0.375      3.111      0.002       0.431       1.901
illeg         -2.4845      1.067     -2.328      0.020      -4.577      -0.392
==============================================================================</code></pre>
</div>
</div>
<p>Based on the F-statistcs, which is anova test for the null hypothesis that at least one of the coefficients is nonzero, we can reject the null hypothesis that all coefficients are zero. This means that at least one of the coefficients is nonzero.</p>
<ol start="3" type="a">
<li>Perform a principled analysis in which you evaluate the overall out-of-sample predictive ability of recre- ational drug use as predictors for ER visits. When writing your response:</li>
</ol>
<div class="cell" data-execution_count="27">
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.755</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>